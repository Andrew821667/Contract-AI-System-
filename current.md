# üìä Contract AI System - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-07
**–í–µ—Ç–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** `claude/plan-idp-integration-2rpCO`
**–°—Ç–∞—Ç—É—Å:** Stage 1 ‚Äî –°—Ç–µ–∫–ª—è–Ω–Ω—ã–π —è—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, DeepSeek –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤:
- **Pre-Execution:** –ê–Ω–∞–ª–∏–∑ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —à–∞–±–ª–æ–Ω–∞–º–∏, —Ä–∏—Å–∫-—Å–∫–æ—Ä–∏–Ω–≥, –ø—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–∑–Ω–æ–≥–ª–∞—Å–∏–π
- **Post-Execution:** –¶–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (macOS)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **Python 3.11** (–ù–ï 3.14 ‚Äî –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å scikit-learn –∏ –¥—Ä—É–≥–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)
- **Homebrew:** `brew install python@3.11`
- API –∫–ª—é—á–∏: DeepSeek (–æ—Å–Ω–æ–≤–Ω–æ–π) + OpenAI (fallback)

### –ü–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd ~/Desktop
git clone https://github.com/Andrew821667/Contract-AI-System-.git
cd Contract-AI-System-
git checkout claude/plan-idp-integration-2rpCO

# 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û Python 3.11!)
python3.11 -m venv venv
source venv/bin/activate

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --upgrade pip
pip install -r requirements.txt
pip install 'openai>=1.50.0'   # –í–ê–ñ–ù–û: openai 1.12.0 –∏–∑ requirements.txt –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å httpx
pip install spacy
python -m spacy download ru_core_news_sm

# 4. –°–æ–∑–¥–∞—Ç—å .env (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ .env.example –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫–ª—é—á–∏)
cp .env.example .env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å: DEEPSEEK_API_KEY, OPENAI_API_KEY, SECRET_KEY

# 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î
python scripts/init_db.py

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å Streamlit (—Å—Ç–µ–∫–ª—è–Ω–Ω—ã–π —è—â–∏–∫)
streamlit run admin/pages/1_Process_Documents.py --server.port=8501 --server.headless=true

# –û—Ç–∫—Ä—ã—Ç—å: http://localhost:8501
```

### ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| `scikit-learn` –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python 3.11, –ù–ï 3.14 |
| `openai` ‚Äî `proxies` error | `pip install 'openai>=1.50.0'` |
| `paddleocr not installed` | –ù–æ—Ä–º–∞–ª—å–Ω–æ ‚Äî OCR –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è .txt/.docx, —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–∫–∞–Ω–æ–≤ |
| `settings.debug` AttributeError | –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ config/settings.py |
| SpaCy –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ | `python -m spacy download ru_core_news_sm` |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 2.0 - –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

### Multi-Model Routing Strategy
- **DeepSeek-chat** ‚Üí –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å (90% –∑–∞–¥–∞—á), $0.14/1M —Ç–æ–∫–µ–Ω–æ–≤
- **GPT-4o-mini** ‚Üí Fallback, $0.15/1M —Ç–æ–∫–µ–Ω–æ–≤
- **Claude 4.5 Sonnet** ‚Üí –°–ª–æ–∂–Ω—ã–µ —Å–∫–∞–Ω—ã (–±—É–¥—É—â–µ–µ), $3.00/1M —Ç–æ–∫–µ–Ω–æ–≤
- **GPT-4o** ‚Üí –†–µ–∑–µ—Ä–≤–Ω—ã–π –∫–∞–Ω–∞–ª, $2.50/1M —Ç–æ–∫–µ–Ω–æ–≤

### Pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏ (5 —ç—Ç–∞–ø–æ–≤ + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π 6-–π)
1. **Text Extraction:** pdfplumber, python-docx, TXT, XML, HTML, OCR (PaddleOCR)
2. **Level 1 Extraction:** regex + SpaCy (–¥–∞—Ç—ã, –ò–ù–ù, —Å—É–º–º—ã) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ
3. **LLM Extraction:** DeepSeek-chat (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON)
4. **RAG Filter:** –û—Ç–∫–ª—é—á–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç PostgreSQL + pgvector)
5. **Validation:** Pydantic v2 —Å—Ö–µ–º—ã + business logic checks
6. **Section Analysis** (–æ–ø—Ü.): –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π LLM-–∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ (~60 —Å–µ–∫)

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** SQLite (`contract_ai.db`)
- **–ü—Ä–æ–¥–∞–∫—à–Ω:** PostgreSQL 16+ (pgvector extension)

---

## üìÅ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

```
Contract-AI-System-/
‚îú‚îÄ‚îÄ .env                                    # API –∫–ª—é—á–∏ (–ù–ï –≤ git!)
‚îú‚îÄ‚îÄ .env.example                            # –®–∞–±–ª–æ–Ω .env
‚îú‚îÄ‚îÄ config/settings.py                      # Pydantic Settings (–º–æ–¥–µ–ª–∏, –ø—É—Ç–∏, —Ä–µ–∂–∏–º—ã)
‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îî‚îÄ‚îÄ pages/1_Process_Documents.py        # Streamlit "–°—Ç–µ–∫–ª—è–Ω–Ω—ã–π —è—â–∏–∫" ‚≠ê
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ document_processor.py           # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–∞–π–ø–ª–∞–π–Ω–∞ ‚≠ê
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ text_extractor.py               # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (PDF/DOCX/TXT/XML/HTML/OCR)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ level1_extractor.py             # Regex + SpaCy NER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ llm_extractor.py                # LLM extraction (DeepSeek/OpenAI) ‚≠ê
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validation_service.py           # Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚≠ê
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ contract_section_analyzer.py    # –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–¥–µ–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ models/database.py                  # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ agents/                             # Multi-agent —Å–∏—Å—Ç–µ–º–∞
‚îú‚îÄ‚îÄ tests/fixtures/test_supply_contract.txt # –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–≥–æ–≤–æ—Ä
‚îú‚îÄ‚îÄ scripts/init_db.py                      # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îî‚îÄ‚îÄ current.md                              # –≠–¢–û–¢ –§–ê–ô–õ
```

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å

**–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø:** Stage 1 ‚Äî –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ ‚úÖ
**–ó–∞–≤–µ—Ä—à–µ–Ω–æ:** 2/5 —ç—Ç–∞–ø–æ–≤ (40%)
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** Stage 2 ‚Äî Pre-Execution (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —à–∞–±–ª–æ–Ω–∞–º–∏, Risk Scoring)

### ‚úÖ Stage 0: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ó–ê–í–ï–†–®–ï–ù)
- ‚úÖ 0.1: –°–æ–∑–¥–∞–Ω–æ 6 –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è 14 —Ç–∞–±–ª–∏—Ü
- ‚úÖ 0.2: –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LLM (DeepSeek, Claude, GPT-4o, GPT-4o-mini)
- ‚úÖ 0.3: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω Smart Router (RAG-assisted, fallback, cost estimation)
- ‚úÖ 0.4: –°–æ–∑–¥–∞–Ω RAG Service (pgvector, semantic search, knowledge base)
- ‚úÖ 0.5: –°–æ–∑–¥–∞–Ω System Config Service (3 —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã)
- ‚úÖ 0.6: Streamlit Admin Dashboard (5 —Å—Ç—Ä–∞–Ω–∏—Ü)

### ‚úÖ Stage 1: Post-Execution MVP (–ó–ê–í–ï–†–®–ï–ù + –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù)
**–ö–æ–º–º–∏—Ç 1 (b0a65c8):**
- ‚úÖ text_extractor.py: PDF, DOCX, TXT, OCR (PaddleOCR)
- ‚úÖ level1_extractor.py: regex + SpaCy –¥–ª—è –±–∞–∑–æ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

**–ö–æ–º–º–∏—Ç 2 (9672f4a):**
- ‚úÖ llm_extractor.py: JSON mode, –ø—Ä–æ–º–ø—Ç —Å –ø–æ–ª–Ω–æ–π —Å—Ö–µ–º–æ–π
- ‚úÖ validation_service.py: Pydantic v2 —Å—Ö–µ–º—ã, business logic checks

**–ö–æ–º–º–∏—Ç 3 (3d34413):**
- ‚úÖ document_processor.py: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–∞–π–ø–ª–∞–π–Ω–∞
- ‚úÖ admin/pages/1_Process_Documents.py: Streamlit "–°—Ç–µ–∫–ª—è–Ω–Ω—ã–π —è—â–∏–∫"

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ (2026-02-07):**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ .txt —Ñ–∞–π–ª–æ–≤ –≤ TextExtractor
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω openai –¥–æ >=1.50.0 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç httpx/proxies)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `settings.debug` –≤ config/settings.py
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `asyncio.run()` ‚Üí `ThreadPoolExecutor` (–∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å event loop Streamlit)
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω PaymentType enum (final_payment, advance, milestone, monthly, quarterly, other)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ `_meta` –ø–æ–ª–µ–π –æ—Ç LLM –ø–µ—Ä–µ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –¥–∞—Ç (LLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "YYYY-MM-DD" —à–∞–±–ª–æ–Ω ‚Üí None)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤–∞–ª–∏–¥–∞—Ç–æ—Ä `vat_included` (—Å—Ç—Ä–æ–∫–∞ ‚Üí bool)
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è PaymentType (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø ‚Üí "other")
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω UI: –≤–ª–æ–∂–µ–Ω–Ω—ã–µ expander ‚Üí –ø—Ä–æ—Å—Ç—ã–µ st.error/st.warning
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω UI: validation_result.status ‚Üí is_valid (bool)
- ‚úÖ DeepSeek-chat —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å
- ‚úÖ LLMExtractor –∏ ContractSectionAnalyzer –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç base_url (DeepSeek API)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (2026-02-07):**
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è Section Analysis: `asyncio.gather()` –≤–º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ (15 –º–∏–Ω ‚Üí 60 —Å–µ–∫)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ XML —Ñ–∞–π–ª–æ–≤ (–ø–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ xml.etree.ElementTree + fallback –Ω–∞ regex)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ HTML/HTM —Ñ–∞–π–ª–æ–≤ (–æ—á–∏—Å—Ç–∫–∞ —Ç–µ–≥–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ script/style)
- ‚úÖ UI: XML/HTML/HTM –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ file_uploader

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–ö–û–î –ü–ò–®–ï–¢–°–Ø –¢–û–õ–¨–ö–û –ü–û –ö–û–ú–ê–ù–î–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø!**
2. –§–∞–π–ª `current.md` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∫ –ø—Ä–æ—á—Ç–µ–Ω–∏—é –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–∞—É–∑—ã
3. –≠—Ç–æ—Ç —Ñ–∞–π–ª –ù–ï —Ä–∞—Å—Ç–µ—Ç, –∞ –û–ë–ù–û–í–õ–Ø–ï–¢–°–Ø (–ø—Ä–æ–≥—Ä–µ—Å—Å, —Å—Ç–∞—Ç—É—Å—ã —á–µ–∫-–ø–æ–∏–Ω—Ç–æ–≤)
4. –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º Stage - —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–∏–º–æ–≥–æ –∫–æ–º–º–∏—Ç–∞

### üî¥ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

6. **UI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ "—Å—Ç–µ–∫–ª—è–Ω–Ω—ã–π —è—â–∏–∫":** –î–ª—è –ö–ê–ñ–î–û–ì–û Stage —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –î–∞—à–±–æ—Ä–¥ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **–í–°–ï –ü–†–û–ú–ï–ñ–£–¢–û–ß–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´** —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
7. **–†–£–°–°–ö–ò–ô –Ø–ó–´–ö:** –í–°–ï –ø–∞–Ω–µ–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–ª–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û –ù–ê –†–£–°–°–ö–û–ú –Ø–ó–´–ö–ï!
8. **–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** `docs/TESTING_STAGE_X.md`
9. **–ß–µ–ª–æ–≤–µ–∫ –≤ —Ü–∏–∫–ª–µ:** –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–∏—Å—Ç–µ–º—ã ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
10. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã:** –°–∏—Å—Ç–µ–º–∞ –≤—ã–¥–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏
11. **–ê–¥–º–∏–Ω-–∫–æ–Ω—Å–æ–ª—å –≤ –î–í–£–• –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö:** Next.js + Streamlit
12. **RAG –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ** (–∫–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á—ë–Ω PostgreSQL)
13. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∂–∏–º–æ–≤ —á–µ—Ä–µ–∑ UI**

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend:** FastAPI (Python 3.11+)
- **Database:** SQLite (dev) / PostgreSQL 16+ (prod, pgvector)
- **ORM:** SQLAlchemy 2.x + Alembic
- **Validation:** Pydantic v2
- **OCR:** PaddleOCR (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **NLP:** SpaCy (ru_core_news_sm)
- **LLM:** DeepSeek-chat (primary), GPT-4o-mini (fallback)
- **UI:** Streamlit (admin dashboard)
- **Async:** asyncio + ThreadPoolExecutor (–¥–ª—è Streamlit)

---

## üìù Intermediate JSON Format

```json
{
  "metadata": { "doc_type": "supply", "confidence": 0.95 },
  "financials": {
    "amount": 100000,
    "currency": "RUB",
    "vat_included": true
  },
  "payment_schedule": [
    { "type": "prepayment", "percent": 30, "due": "2026-02-01" }
  ],
  "rules": [
    {
      "type": "penalty",
      "trigger": "delay",
      "description": "0.1% per day limited to 10%",
      "structured_formula": { "rate": 0.001, "cap": 0.1 }
    }
  ]
}
```

---

## üìã –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è (–æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç—Ç–∞–ø—ã)

### Stage 2: Pre-Execution (–°–ª–µ–¥—É—é—â–∏–π)
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —à–∞–±–ª–æ–Ω–∞–º–∏/Playbook
- [ ] Risk Scoring Engine
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Ä–∞–∑–Ω–æ–≥–ª–∞—Å–∏–π

### Stage 3: Smart Router Production
- [ ] –û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (complexity_score)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ DeepSeek ‚Üî Claude
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

### Stage 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ + UI
- [ ] –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (pgvector)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1C/ERP
- [ ] UI –¥–ª—è —é—Ä–∏—Å—Ç–æ–≤
- [ ] Dashboard –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
