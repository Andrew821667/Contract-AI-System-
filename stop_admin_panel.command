#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ Contract AI System

echo "‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Contract AI System Admin Panel..."
echo "================================================"

# –ù–∞—Ö–æ–¥–∏–º –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Streamlit
PIDS=$(ps aux | grep 'streamlit run' | grep -v grep | awk '{print $2}')

if [ -z "$PIDS" ]; then
    echo "‚ÑπÔ∏è –ü—Ä–æ—Ü–µ—Å—Å—ã Streamlit –Ω–µ –Ω–∞–π–¥–µ–Ω—ã (–≤–æ–∑–º–æ–∂–Ω–æ, —É–∂–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)"
else
    echo "üîç –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å—ã Streamlit: $PIDS"

    for PID in $PIDS; do
        echo "‚èπÔ∏è –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –ø—Ä–æ—Ü–µ—Å—Å $PID..."
        kill $PID 2>/dev/null

        # –ñ–¥–µ–º 2 —Å–µ–∫—É–Ω–¥—ã
        sleep 2

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å
        if ps -p $PID > /dev/null 2>&1; then
            echo "‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å $PID –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è, –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞..."
            kill -9 $PID 2>/dev/null
        fi
    done

    echo "‚úÖ –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Streamlit –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
fi

# –¢–∞–∫–∂–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ Python –ø—Ä–æ—Ü–µ—Å—Å—ã
PYTHON_PIDS=$(ps aux | grep 'python.*streamlit' | grep -v grep | awk '{print $2}')

if [ ! -z "$PYTHON_PIDS" ]; then
    echo "üîç –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —Å–≤—è–∑–∞–Ω–Ω—ã–µ Python –ø—Ä–æ—Ü–µ—Å—Å—ã..."
    for PID in $PYTHON_PIDS; do
        kill $PID 2>/dev/null
    done
fi

echo "================================================"
echo "‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞..."
