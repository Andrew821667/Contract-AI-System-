# üöÄ –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò - Contract AI System

## –û–±–∑–æ—Ä

–î–æ–±–∞–≤–ª–µ–Ω—ã —Ç—Ä–∏ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–≤–æ–¥—è—Ç —Å–∏—Å—Ç–µ–º—É –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å:

1. **ML Risk Predictor** - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–∏—Å–∫–æ–≤ –∑–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
2. **Risk Analytics Dashboard** - –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏
3. **Smart Contract Composer** - AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤
4. **Enhanced RAG System** - –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏

---

## 1Ô∏è‚É£ ML Risk Predictor

### –û–ø–∏—Å–∞–Ω–∏–µ
–ú–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–∞.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚ö° **–°–∫–æ—Ä–æ—Å—Ç—å:** <100ms (vs 2-5 –º–∏–Ω—É—Ç –¥–ª—è LLM)
- üí∞ **–≠–∫–æ–Ω–æ–º–∏—è:** 60% —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ LLM
- üéØ **–¢–æ—á–Ω–æ—Å—Ç—å:** 85%+ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è
- üîÑ **–û–±—É—á–µ–Ω–∏–µ:** –£–ª—É—á—à–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**Python API:**
```python
from src.ml import quick_predict_risk

prediction = quick_predict_risk({
    'contract_type': 'supply',
    'amount': 1000000,
    'duration_days': 365,
    'has_force_majeure': True,
    'has_liability_limit': False,
    'counterparty_risk_score': 65
})

print(f"Risk Level: {prediction.risk_level}")  # high
print(f"Risk Score: {prediction.risk_score}")   # 72.5
print(f"Confidence: {prediction.confidence}")   # 0.89

if prediction.should_use_llm:
    # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π LLM –∞–Ω–∞–ª–∏–∑
    full_analysis()
else:
    # ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–Ω–æ–µ
    use_ml_prediction()
```

**REST API:**
```bash
POST /api/v1/ml/predict-risk
Content-Type: application/json

{
  "contract_type": "supply",
  "amount": 1000000,
  "duration_days": 365,
  "has_force_majeure": true,
  "has_liability_limit": false
}

# –û—Ç–≤–µ—Ç:
{
  "risk_level": "high",
  "risk_score": 72.5,
  "confidence": 0.89,
  "should_use_llm": true,
  "prediction_time_ms": 45.2
}
```

### –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏
```python
from src.ml import MLRiskPredictor

predictor = MLRiskPredictor()

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
training_data = [
    {'contract_type': 'supply', 'amount': 100000, ...},
    {'contract_type': 'service', 'amount': 50000, ...},
    # ... –µ—â–µ 100+ –ø—Ä–∏–º–µ—Ä–æ–≤
]

labels = ['high', 'low', 'medium', 'high', ...]  # –†–µ–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞

# –û–±—É—á–∏—Ç—å
predictor.train(training_data, labels)

# –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# models/risk_predictor.pkl
```

---

## 2Ô∏è‚É£ Risk Analytics Dashboard

### –û–ø–∏—Å–∞–Ω–∏–µ
–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏, —Ç—Ä–µ–Ω–¥–∞–º–∏ –∏ –∏–Ω—Å–∞–π—Ç–∞–º–∏.

### –ú–µ—Ç—Ä–∏–∫–∏

#### Headline Metrics (–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏)
- **Contracts Analyzed** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- **Time Saved** - —Å—ç–∫–æ–Ω–æ–º–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è (—á–∞—Å—ã)
- **Cost Saved** - —Å—ç–∫–æ–Ω–æ–º–ª–µ–Ω–Ω—ã–µ –¥–µ–Ω—å–≥–∏ (USD)
- **Acceptance Rate** - –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π AI
- **Average Risk Score** - —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Ä–∏—Å–∫–∞

#### Risk Trends (–¢—Ä–µ–Ω–¥—ã —Ä–∏—Å–∫–æ–≤)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ critical/high/medium/low —Ä–∏—Å–∫–æ–≤ –ø–æ –¥–Ω—è–º/–Ω–µ–¥–µ–ª—è–º
- –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Ä–∏—Å–∫–∞
- –¢—Ä–µ–Ω–¥—ã (—Ä–∞—Å—Ç—É—â–∏–µ/–ø–∞–¥–∞—é—â–∏–µ)

#### Cost Analysis (–ê–Ω–∞–ª–∏–∑ –∑–∞—Ç—Ä–∞—Ç)
- –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å LLM –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢–æ–∫–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã
- –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä
- **–≠–∫–æ–Ω–æ–º–∏—è –æ—Ç ML** (60% —Å–Ω–∏–∂–µ–Ω–∏–µ)
- –ü—Ä–æ–≥–Ω–æ–∑ –º–µ—Å—è—á–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç

#### Productivity (–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- –î–æ–≥–æ–≤–æ—Ä–æ–≤ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
- –í—Ä–µ–º—è —Å—ç–∫–æ–Ω–æ–º–ª–µ–Ω–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- **ROI multiplier** (5x, 10x, etc.)

#### Top Risks (–¢–æ–ø —Ä–∏—Å–∫–æ–≤)
- 10 —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Ä–∏—Å–∫–æ–≤
- Severity –∫–∞–∂–¥–æ–≥–æ
- –¢—Ä–µ–Ω–¥ (—Ä–∞—Å—Ç–µ—Ç/–ø–∞–¥–∞–µ—Ç)

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**Python API:**
```python
from src.services.analytics_service import get_analytics_service

analytics = get_analytics_service()

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞—à–±–æ—Ä–¥
dashboard = analytics.get_dashboard_summary(
    user_id='user-123',
    period_days=30
)

print(f"Contracts analyzed: {dashboard['headline_metrics']['total_contracts'].value}")
print(f"Time saved: {dashboard['headline_metrics']['time_saved'].value} hours")
print(f"ROI: {dashboard['productivity'].roi_multiplier}x")

# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
for rec in dashboard['recommendations']:
    print(f"{rec['type']}: {rec['message']}")
```

**REST API:**
```bash
GET /api/v1/analytics/dashboard?period_days=30&token=xxx

# –û—Ç–≤–µ—Ç:
{
  "period": {"start": "2025-10-16", "end": "2025-11-15", "days": 30},
  "headline_metrics": {
    "total_contracts": {"value": 127, "trend": "up", "trend_percentage": 29.6},
    "time_saved": {"value": 847.5, "unit": "hours", "trend": "up"},
    "cost_saved": {"value": 12450.0, "unit": "USD"},
    "acceptance_rate": {"value": 94, "unit": "%"}
  },
  "risk_trends": [...],
  "cost_analysis": {
    "total_cost_usd": 423.5,
    "llm_calls": 847,
    "ml_prediction_savings": 634.2,
    "estimated_monthly_cost": 423.5
  },
  "productivity": {
    "contracts_analyzed": 127,
    "total_time_saved_hours": 847.5,
    "roi_multiplier": 16.9
  },
  "top_risks": [
    {"risk_type": "Unlimited Liability", "count": 23, "severity": "high", "trend": "increasing"},
    {"risk_type": "Missing Force Majeure", "count": 18, "severity": "medium"},
    ...
  ],
  "recommendations": [
    {
      "type": "success",
      "title": "Excellent ROI",
      "message": "System is delivering 16.9x ROI!",
      "priority": "low"
    }
  ]
}
```

### –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤
```python
# –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON/CSV/PDF
filepath = analytics.export_analytics_report(
    format='pdf',  # –∏–ª–∏ 'json', 'csv'
    period_days=30
)
# reports/analytics/analytics_report_20251115_143025.pdf
```

```bash
POST /api/v1/analytics/export
{
  "format": "pdf",
  "period_days": 30
}

# –°–∫–∞—á–∏–≤–∞–µ—Ç—Å—è PDF —Ñ–∞–π–ª
```

---

## 3Ô∏è‚É£ Smart Contract Composer

### –û–ø–∏—Å–∞–Ω–∏–µ
AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (–∫–∞–∫ GitHub Copilot –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤).

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ü§ñ **AI –ø–æ–¥—Å–∫–∞–∑–∫–∏** - –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∫–ª–∞—É–∑
- ‚úÖ **Real-time –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∏—Å–∫–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ
- üìö **RAG –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –∫–æ–º–ø–∞–Ω–∏–∏
- üéØ **–®–∞–±–ª–æ–Ω—ã** - 50+ –≥–æ—Ç–æ–≤—ã—Ö –∫–ª–∞—É–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- üí° **Inline help** - –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–ù–∞—á–∞–ª–æ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏:**
```python
from src.services.smart_composer import create_smart_composer

composer = create_smart_composer()

context = composer.start_composition(
    contract_type='supply',
    parties=['–û–û–û "–ü–æ—Å—Ç–∞–≤—â–∏–∫"', '–û–û–û "–ü–æ–∫—É–ø–∞—Ç–µ–ª—å"'],
    template_id='supply-standard-v2'
)
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ AI –ø–æ–¥—Å–∫–∞–∑–æ–∫:**
```python
# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–µ—á–∞—Ç–∞—Ç—å...
current_text = "The Supplier shall deliver"

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
async for suggestion in composer.get_suggestions(context, current_text):
    print(f"Suggestion: {suggestion.text}")
    print(f"Confidence: {suggestion.confidence}")
    print(f"Explanation: {suggestion.explanation}")

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
# Suggestion: "The Supplier shall deliver goods within 30 days of order receipt."
# Confidence: 0.92
# Explanation: "Standard delivery timeline for supply contracts"
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
```python
clause = "Payment within reasonable time"

validation = composer.validate_clause(context, clause)

if not validation.is_valid:
    for issue in validation.issues:
        print(f"{issue['type']}: {issue['message']}")
    # warning: Ambiguous term 'reasonable'. Be more specific.
    # error: Payment clause missing deadline.

for suggestion in validation.suggestions:
    print(f"üí° {suggestion}")
    # üí° Add timeline: e.g., "within 30 days of invoice date"
```

**REST API:**
```bash
# 1. –ù–∞—á–∞—Ç—å –∫–æ–º–ø–æ–∑–∏—Ü–∏—é
POST /api/v1/ml/composer/start
{
  "contract_type": "supply",
  "parties": ["Company A", "Company B"]
}

# –û—Ç–≤–µ—Ç:
{
  "session_id": "abc-123-def",
  "suggested_sections": [
    "Preamble", "Definitions", "Subject Matter", ...
  ]
}

# 2. –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏
POST /api/v1/ml/composer/suggest
{
  "session_id": "abc-123-def",
  "current_text": "The Supplier shall deliver"
}

# –û—Ç–≤–µ—Ç:
{
  "suggestions": [
    {
      "text": "The Supplier shall deliver goods within 30 days...",
      "confidence": 0.92,
      "explanation": "Standard delivery clause"
    }
  ]
}

# 3. –í–∞–ª–∏–¥–∞—Ü–∏—è
POST /api/v1/ml/composer/validate
{
  "session_id": "abc-123-def",
  "clause_text": "Payment within reasonable time"
}

# –û—Ç–≤–µ—Ç:
{
  "is_valid": false,
  "issues": [
    {"type": "warning", "message": "Ambiguous term 'reasonable'"}
  ],
  "suggestions": ["Add specific timeline"],
  "risk_score": 65.5
}
```

### Inline Help
```python
help_text = composer.get_inline_help("force majeure")

print(help_text)
# "Unforeseen circumstances that prevent fulfilling a contract.
#  Include specific examples and notification requirements."
```

---

## 4Ô∏è‚É£ Enhanced RAG System

### –û–ø–∏—Å–∞–Ω–∏–µ
–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ RAG —Å –æ–±—É—á–µ–Ω–∏–µ–º –Ω–∞ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –≥–∏–±—Ä–∏–¥–Ω—ã–º –ø–æ–∏—Å–∫–æ–º.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- üìö **Multi-source search** - –ø–æ–∏—Å–∫ –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º + –ë–ó + legal docs
- üîç **Hybrid search** - vector + keyword + re-ranking
- üß† **Company KB** - –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–∏—Ç–∏–∫–∞—Ö/—à–∞–±–ª–æ–Ω–∞—Ö –∫–æ–º–ø–∞–Ω–∏–∏
- üìä **Usage tracking** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–Ω–∞–Ω–∏–π
- ‚ö° **Caching** - 30-–º–∏–Ω—É—Ç–Ω—ã–π –∫—ç—à –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–Ω–∞–Ω–∏–π

**3 –∏—Å—Ç–æ—á–Ω–∏–∫–∞:**
1. **Contracts** - –¥–æ–≥–æ–≤–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **Company KB** - –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏ (–ø–æ–ª–∏—Ç–∏–∫–∏, —à–∞–±–ª–æ–Ω—ã, –ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç—ã, guidelines)
3. **Legal Docs** - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∑–∞–∫–æ–Ω—ã

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π:**
```python
from src.services.enhanced_rag import get_enhanced_rag

rag = get_enhanced_rag()

kb_id = rag.add_company_knowledge(
    title="–ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏",
    content="1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ò–ù–ù —á–µ—Ä–µ–∑ –§–ù–° –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞...",
    category='policy',  # policy/template/precedent/guideline
    tags=['–∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã', '–ø—Ä–æ–≤–µ—Ä–∫–∞', '–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å'],
    author='–ò–≤–∞–Ω–æ–≤ –ò.–ò.'
)
```

**–ü–æ–∏—Å–∫:**
```python
results = rag.search(
    query="–∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞",
    top_k=10,
    search_contracts=True,  # –∏—Å–∫–∞—Ç—å –≤ –¥–æ–≥–æ–≤–æ—Ä–∞—Ö
    search_kb=True,         # –∏—Å–∫–∞—Ç—å –≤ –ë–ó –∫–æ–º–ø–∞–Ω–∏–∏
    search_legal=False,     # –Ω–µ –∏—Å–∫–∞—Ç—å –≤ legal docs
    use_reranking=True      # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å re-ranking
)

for result in results:
    print(f"Score: {result.score:.3f}")
    print(f"Source: {result.source}")  # 'contract', 'kb', 'legal_doc'
    print(f"Content: {result.content[:200]}...")
```

**REST API:**
```bash
POST /api/v1/ml/rag/search
{
  "query": "–∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞",
  "top_k": 10,
  "search_kb": true
}

# –û—Ç–≤–µ—Ç:
{
  "query": "–∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞",
  "results_count": 10,
  "results": [
    {
      "content": "1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ò–ù–ù —á–µ—Ä–µ–∑ –§–ù–° –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞...",
      "score": 0.921,
      "source": "kb",
      "document_id": "kb-12345",
      "metadata": {
        "title": "–ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏",
        "category": "policy",
        "author": "–ò–≤–∞–Ω–æ–≤ –ò.–ò."
      }
    }
  ]
}
```

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API:**
```bash
POST /api/v1/ml/kb/add
{
  "title": "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–ª–∞—É–∑–∞ —Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä",
  "content": "–°—Ç–æ—Ä–æ–Ω—ã –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏...",
  "category": "template",
  "tags": ["—Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä", "—Å—Ç–∞–Ω–¥–∞—Ä—Ç"]
}

# –û—Ç–≤–µ—Ç:
{
  "success": true,
  "kb_id": "kb-abc123",
  "message": "Knowledge entry added successfully"
}
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–ó:**
```python
stats = rag.get_kb_statistics()

print(f"Total entries: {stats['total_entries']}")
print(f"Categories: {stats['categories']}")
print(f"Top tags: {stats['top_tags']}")
print(f"Most used: {stats['most_used']}")
```

```bash
GET /api/v1/ml/kb/statistics

# –û—Ç–≤–µ—Ç:
{
  "total_entries": 47,
  "categories": {
    "policy": 12,
    "template": 18,
    "precedent": 10,
    "guideline": 7
  },
  "top_tags": {
    "–∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã": 15,
    "—Ä–∏—Å–∫–∏": 12,
    "–ø–ª–∞—Ç–µ–∂–∏": 10
  },
  "most_used": [
    {
      "title": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤",
      "usage_count": 234,
      "effectiveness_score": 0.92
    }
  ]
}
```

**–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞—Ö:**
```python
# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∏—Ç—Å—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –∞–Ω–∞–ª–∏–∑–∞
rag.learn_from_analysis(
    contract_id='contract-123',
    analysis_result={
        'risks': [...],
        'recommendations': [...]
    }
)

# –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω —Ä–∏—Å–∫–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è 3+ —Ä–∞–∑–∞,
# –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ –ë–ó:
# "Common Risk Pattern: Missing termination clause"
```

---

## üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ:

```python
# 1. ML Predictor –±—ã—Å—Ç—Ä–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Ä–∏—Å–∫
prediction = quick_predict_risk(contract_data)

if prediction.should_use_llm:
    # 2. –ï—Å–ª–∏ —Ä–∏—Å–∫ –≤—ã—Å–æ–∫–∏–π - –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑
    # Enhanced RAG –∏—â–µ—Ç –ø–æ—Ö–æ–∂–∏–µ —Å–ª—É—á–∞–∏ –≤ –ë–ó
    similar_cases = rag.search(
        query=f"risk analysis for {contract_data['contract_type']}",
        search_kb=True
    )

    # 3. LLM –∞–Ω–∞–ª–∏–∑ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ RAG
    analysis_result = analyzer.analyze(contract, context=similar_cases)

    # 4. RAG —É—á–∏—Ç—Å—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
    rag.learn_from_analysis(contract_id, analysis_result)

    # 5. Analytics —Ç—Ä–µ–∫–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
    analytics.track_metric(
        name='llm_analysis_time',
        value=analysis_result.duration_seconds,
        unit='seconds',
        metric_type=MetricType.PRODUCTIVITY
    )
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ –∏ –ü–æ—Å–ª–µ

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚è±Ô∏è –ê–Ω–∞–ª–∏–∑: 2-5 –º–∏–Ω—É—Ç
- üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: $0.50-2.00 –∑–∞ –¥–æ–≥–æ–≤–æ—Ä
- üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ü§ñ AI –ø–æ–º–æ—â—å: —Ç–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- üìö –ó–Ω–∞–Ω–∏—è: –Ω–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚ö° –ê–Ω–∞–ª–∏–∑: <1 —Å–µ–∫—É–Ω–¥–∞ (ML) –∏–ª–∏ 2-5 –º–∏–Ω—É—Ç (LLM –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö)
- üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: $0.00 (60% –¥–æ–≥–æ–≤–æ—Ä–æ–≤) + $0.50-2.00 (40%)
- üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: –ø–æ–ª–Ω—ã–π dashboard —Å ROI, —Ç—Ä–µ–Ω–¥–∞–º–∏, –∏–Ω—Å–∞–π—Ç–∞–º–∏
- ü§ñ AI –ø–æ–º–æ—â—å: —Å–æ–∑–¥–∞–Ω–∏–µ + –∞–Ω–∞–ª–∏–∑ + –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìö –ó–Ω–∞–Ω–∏—è: –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –∏ —É–ª—É—á—à–∞—é—Ç—Å—è —Å –∫–∞–∂–¥—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

### ROI:
- **60% —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç** –Ω–∞ LLM
- **100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤
- **5-20x ROI** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- –ò–∑–º–µ—Ä–∏–º–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ analytics

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- `scikit-learn==1.3.2` - ML –º–æ–¥–µ–ª—å
- `numpy==1.26.3` - —á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- `scipy==1.11.4` - –Ω–∞—É—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```python
# ML Risk Predictor –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
from src.ml import quick_predict_risk

# Enhanced RAG —Ç—Ä–µ–±—É–µ—Ç ChromaDB –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
from src.services.enhanced_rag import get_enhanced_rag
rag = get_enhanced_rag()  # –°–æ–∑–¥–∞—Å—Ç ./data/chroma_enhanced

# Analytics Service
from src.services.analytics_service import get_analytics_service
analytics = get_analytics_service()

# Smart Composer
from src.services.smart_composer import create_smart_composer
composer = create_smart_composer()
```

### 3. –ó–∞–ø—É—Å–∫ FastAPI —Å–µ—Ä–≤–µ—Ä–∞

```bash
python -m uvicorn src.main:app --reload
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000

**–ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- http://localhost:8000/docs#tag/ml-ai
- http://localhost:8000/docs#tag/analytics

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **–ö–æ–¥:**
  - `src/ml/risk_predictor.py` - ML –º–æ–¥–µ–ª—å
  - `src/services/analytics_service.py` - Analytics
  - `src/services/smart_composer.py` - Composer
  - `src/services/enhanced_rag.py` - RAG system

- **API:**
  - `src/api/ml/routes.py` - ML & AI endpoints
  - `src/api/analytics/routes.py` - Analytics endpoints

- **–¢–µ—Å—Ç—ã:**
  - TODO: `tests/test_ml_predictor.py`
  - TODO: `tests/test_analytics.py`
  - TODO: `tests/test_smart_composer.py`
  - TODO: `tests/test_enhanced_rag.py`

---

## üí° Best Practices

### ML Risk Predictor
1. **–û–±—É—á–∞–π—Ç–µ –º–æ–¥–µ–ª—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ** (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü) –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ feedback** –æ—Ç —é—Ä–∏—Å—Ç–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ confidence** - –µ—Å–ª–∏ <70%, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ LLM

### Analytics
1. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –æ—Ç—á–µ—Ç—ã** –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤
2. **–°–º–æ—Ç—Ä–∏—Ç–µ recommendations** - —Ç–∞–º —Ü–µ–Ω–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã
3. **–¢—Ä–µ–∫–∞–π—Ç–µ ROI** –¥–ª—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

### Smart Composer
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ templates** - –æ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã —é—Ä–∏—Å—Ç–∞–º–∏
2. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥—É—é –∫–ª–∞—É–∑—É** –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ –¥–æ–≥–æ–≤–æ—Ä
3. **–ò–∑—É—á–∞–π—Ç–µ inline help** –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤

### Enhanced RAG
1. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –∑–Ω–∞–Ω–∏—è** –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤–∞–∂–Ω–æ–≥–æ –∫–µ–π—Å–∞
2. **–¢–µ–≥–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - —ç—Ç–æ —É–ª—É—á—à–∞–µ—Ç –ø–æ–∏—Å–∫
3. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ KB** - —É–¥–∞–ª—è–π—Ç–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏

---

**–°–æ–∑–¥–∞–Ω–æ:** 15 –Ω–æ—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 2.0.0
**–ê–≤—Ç–æ—Ä:** AI Contract System Team
